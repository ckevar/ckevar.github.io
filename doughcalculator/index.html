<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
	<link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,700;1,600&display=swap" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<script type="text/javascript">
		
		var languageOptions = '<option value="" selected hidden disabled>Choose here</option> <option value="Remove">Remove Language</option> <option value="Afrikaans">Afrikaans</option> <option value="Albanian">Albanian</option> <option value="Amharic">Amharic</option> <option value="Arabic">Arabic</option> <option value="Armenian">Armenian</option> <option value="Assamese">Assamese</option> <option value="Aymara">Aymara</option> <option value="Azerbaijani">Azerbaijani</option> <option value="Bambara">Bambara</option> <option value="Basque">Basque</option> <option value="Belarusian">Belarusian</option> <option value="Bengali">Bengali</option> <option value="Bhojpuri">Bhojpuri</option> <option value="Bosnian">Bosnian</option> <option value="Bulgarian">Bulgarian</option> <option value="Catalan">Catalan</option> <option value="Cebuano">Cebuano</option> <option value="Chewa">Chewa</option> <option value="Chinese">Chinese (Simplified)</option> <option value="Chinese">Chinese (Traditional)</option> <option value="Corsican">Corsican</option> <option value="Croatian">Croatian</option> <option value="Czech">Czech</option> <option value="Danish">Danish</option> <option value="Dhivehi">Dhivehi</option> <option value="Dogri">Dogri</option> <option value="Dutch">Dutch</option> <option value="English">English</option> <option value="Esperanto">Esperanto</option> <option value="Estonian">Estonian</option> <option value="Ewe">Ewe</option> <option value="Filipino">Filipino</option> <option value="Finnish">Finnish</option> <option value="French">French</option> <option value="Frisian">Frisian</option> <option value="Galician">Galician</option> <option value="Georgian">Georgian</option> <option value="German">German</option> <option value="Greek">Greek</option> <option value="Guarani">Guarani</option> <option value="Gujarati">Gujarati</option> <option value="Haitian">Haitian Creole</option> <option value="Hausa">Hausa</option> <option value="Hawaiian">Hawaiian</option> <option value="Hebrew">Hebrew</option> <option value="Hindi">Hindi</option> <option value="Hmong">Hmong</option> <option value="Hungarian">Hungarian</option> <option value="Icelandic">Icelandic</option> <option value="Igbo">Igbo</option> <option value="Ilocano">Ilocano</option> <option value="Indonesian">Indonesian</option> <option value="Irish">Irish</option> <option value="Italian">Italian</option> <option value="Japanese">Japanese</option> <option value="Javanese">Javanese</option> <option value="Kannada">Kannada</option> <option value="Kazakh">Kazakh</option> <option value="Khmer">Khmer</option> <option value="Kinyarwanda">Kinyarwanda</option> <option value="Konkani">Konkani</option> <option value="Korean">Korean</option> <option value="Krio">Krio</option> <option value="Kurdish">Kurdish (Kurmanji)</option> <option value="Kurdish">Kurdish (Sorani)</option> <option value="Kyrgyz">Kyrgyz</option> <option value="Lao">Lao</option> <option value="Latin">Latin</option> <option value="Latvian">Latvian</option> <option value="Lingala">Lingala</option> <option value="Lithuanian">Lithuanian</option> <option value="Luganda">Luganda</option> <option value="Luxembourgish">Luxembourgish</option> <option value="Macedonian">Macedonian</option> <option value="Maithili">Maithili</option> <option value="Malagasy">Malagasy</option> <option value="Malay">Malay</option> <option value="Malayalam">Malayalam</option> <option value="Maltese">Maltese</option> <option value="Maori">Maori</option> <option value="Marathi">Marathi</option> <option value="Meiteilon">Meiteilon (Manipuri)</option> <option value="Mizo">Mizo</option> <option value="Mongolian">Mongolian</option> <option value="Myanmar">Myanmar (Burmese)</option> <option value="Nepali">Nepali</option> <option value="Norwegian">Norwegian</option> <option value="Odia">Odia (Oriya)</option> <option value="Oromo">Oromo</option> <option value="Pashto">Pashto</option> <option value="Persian">Persian</option> <option value="Polish">Polish</option> <option value="Portuguese">Portuguese</option> <option value="Punjabi">Punjabi</option> <option value="Quechua">Quechua</option> <option value="Romanian">Romanian</option> <option value="Russian">Russian</option> <option value="Samoan">Samoan</option> <option value="Sanskrit">Sanskrit</option> <option value="Scots">Scots Gaelic</option> <option value="Sepedi">Sepedi</option> <option value="Serbian">Serbian</option> <option value="Shona">Shona</option> <option value="Sindhi">Sindhi</option> <option value="Sinhala">Sinhala</option> <option value="Slovak">Slovak</option> <option value="Slovenian">Slovenian</option> <option value="Somali">Somali</option> <option value="Sotho">Sotho</option> <option value="Spanish">Spanish</option> <option value="Sundanese">Sundanese</option> <option value="Swahili">Swahili</option> <option value="Swedish">Swedish</option> <option value="Tajik">Tajik</option> <option value="Tamil">Tamil</option> <option value="Tatar">Tatar</option> <option value="Telugu">Telugu</option> <option value="Thai">Thai</option> <option value="Tigrinya">Tigrinya</option> <option value="Tsonga">Tsonga</option> <option value="Turkish">Turkish</option> <option value="Turkmen">Turkmen</option> <option value="Twi">Twi</option> <option value="Ukrainian">Ukrainian</option> <option value="Urdu">Urdu</option> <option value="Uyghur">Uyghur</option> <option value="Uzbek">Uzbek</option> <option value="Vietnamese">Vietnamese</option> <option value="Welsh">Welsh</option> <option value="Xhosa">Xhosa</option> <option value="Yiddish">Yiddish</option> <option value="Yoruba">Yoruba</option> <option value="Zulu">Zulu</option>';
		sectionsOptions = '<option value="" selected hidden disabled>Choose here</option> <option value="Remove">Remove Section</option> <option value="Greetings">Greetings</option> <option value="Education">Education</option> <option value="Experience">Experience</option> <option value="Projects">Projects</option> <option value="Press">Press</option> <option value="Photography">Photography</option> <option value="Misc">Misc</option>';

		function addNewOptionLS(elemnt, fooNameToAdd, divWhereToAdd, optionsToAdd) {
			if (elemnt) {
				if (elemnt.value == "Remove") return;
			}
			const selectChild = document.createElement('select');
			selectChild.setAttribute("onchange",fooNameToAdd);
			selectChild.setAttribute("class","optionmenus-selection");
			selectChild.innerHTML = optionsToAdd; 
			document.getElementById(divWhereToAdd).appendChild(selectChild);
		}

		function popupMenuLS(divToCheck, addNewFoo, divToPop) {
			if(document.getElementById(divToCheck).children.length == 0)
				addNewFoo(null);
    		document.getElementById(divToPop).style.display = "block";
		}

		function closeMenuLS(divToHide, divToGetElements, inputToWrite) {
			document.getElementById(divToHide).style.display = "none";
    		var listOptions = document.getElementById(divToGetElements);
    		var value = '';
    		
    		for (var i = 0; i < listOptions.children.length; i++) {
    			if (listOptions.children[i].value == "Remove") {
    				listOptions.children[i].remove();
    			} else if (listOptions.children[i].value)
    				value = value + listOptions.children[i].value + ', ';
    		}

    		document.getElementById(inputToWrite).value = value;
		}

		function addNewLanguage(elemnt){
			addNewOptionLS(elemnt, "addNewLanguage(this)", "languageslistid", languageOptions);
		}

    	function popupLanguages() {
    		popupMenuLS("languageslistid", addNewLanguage, "languagesmenuid");
 		}

 		function closelanguagesmenu() {
 			closeMenuLS("languagesmenuid", "languageslistid", "languagesid");
 		}

 		function addNewSection(elemnt) {
			addNewOptionLS(elemnt, "addNewSection(this)", "sectionslistid", sectionsOptions);	
 		}

 		function popupSections() {
    		popupMenuLS("sectionslistid", addNewSection, "sectionsmenuid");
 		}

 		function closesectionsmenu() {
 			closeMenuLS("sectionsmenuid", "sectionslistid", "sectionsid");
 		}

   	 	function registerFoo() {
   	 		function popMI(msg) {
   	 			var popMIdiv = document.getElementById("missingInformation");
   	 			popMIdiv.style.display = "block";
    			popMIdiv.style.color = "white";
    			popMIdiv.style.background = "red";
    			document.getElementById("missingInformationMSG").innerHTML = msg;
   	 		}

   	 		function checkPopMenusLS(divToCheck, msg) {
   	 			var sectionsList = document.getElementById(divToCheck);
				if(sectionsList.children.length == 0) {
					popMI(msg);
					return 1;
				}
				else if (!sectionsList.children[0].value) {
					popMI(msg);
					return 1;
				}
				else if (sectionsList.children[0].value == "Remove") {
					popMI(msg);
					return 1;
				}
   	 		}

   	 		function reqListener() {
   				var jsonr = JSON.parse(this.responseText);
   				document.getElementById("loggin_id").style.display = "none";

   				if(jsonr.status == "user not available") {
   					document.getElementById("oops_id").style.display = "block";
   					document.getElementById("reasons404").innerHTML = "User not available";

   				} else if (jsonr.status == "token timeout") {
   					document.getElementById("oops_id").style.display = "block";
   					document.getElementById("reasons404").innerHTML = "Token Issues";

   				} else if (jsonr.status == "newUser") {
   					document.getElementById("register_id").style.display = "flex";

   				} else {
   					document.getElementById("oops_id").style.display = "block";
   				}

   			}

   			var nameSTR = document.getElementById("nameid").value;
    		if(!nameSTR) {
    			popMI("Your <b>name</b> is missing");
    			return;
    		}
    		
    		var lastNameSTR = !document.getElementById("lastNameid").value;
    		if(!lastNameSTR) {
    			popMI("Your <b>last name</b> is missing");
    			return;
    		}
    		if (checkPopMenusLS("languageslistid", "I think at least you speak <b>English</br>"))
    			return;

    		if (checkPopMenusLS("sectionslistid", "You need minimum a <b>Greetings</b> section"))
    			return;
    		
   			// var oReq = new XMLHttpRequest(); 
   			// oReq.addEventListener("load", reqListener);
   			// oReq.open("POST", "https://2cj2ftp0e0.execute-api.us-east-1.amazonaws.com/default/telegramCook", true);
   			// oReq.send(JSON.stringify({name: nameSTR, lastName: lastNameSTR}));
			

    	}

    	function closeMissInformation() {
    			document.getElementById("missingInformation").style.display = "none";
    	}

	</script>

  </head>
  <body>
    <div id="g_id_onload" data-client_id="34306858084-r488ik83fedb7sgggfj9ft4lgmurjnhe.apps.googleusercontent.com" data-callback="handleCredentialResponse" style="position: absolute; top: 100px; right: 30px;
            width: 0; height: 0; z-index: 1001;"></div>
	<div class="loggin" id="loggin_id">
		<div class="loggin-col loggin-col-left">
			<div class="loggin-col-content">
				<h1>Your Space,<br>Your Life.</h1>
				<p>Your career starts here, built your CV with us.</p>	
			</div>
		</div>
		<div class="loggin-col">
			<div class="loggin-col-content">
				<h2>Let's Prepare for Launch</h2>
				<div id="buttonDiv" ></div>				
			</div>
		</div>
	</div>

	<div class="oops" id="oops_id">
		<div class="oops-text">
			<h1>404</h1>
			<p id="reasons404">We couldn't find what you're looking for.</p>
		</div>
	</div>

	<div class="register" id="register_id">
		<h2>Registration Form</h2>
		<form>
			<label for="nameid">Name</label>
			<input type="text" id="nameid">

			<label for="lastNameid">Last Name</label>
			<input type="text" id="lastNameid">

			<label for="languagesid">Languages</label>
			<input type="text" id="languagesid" onclick="popupLanguages()">

			<label for="sectionsid">Sections</label>
			<input type="text" id="sectionsid" onclick="popupSections()">
			
			<button type="button" onclick="registerFoo()">Register</button>

		</form>
		
 	</div>

	<div class="floatingmenu" id="languagesmenuid">
 		<h2>Languages you speak:</h2>
 		<div id="languageslistid">
 		</div>
 		<i class="fa fa-times" onclick="closelanguagesmenu()"></i>
 		<p>To remove just select <b>Remove Language</b></p>
 	</div>

 	<div class="floatingmenu" id="sectionsmenuid">
 		<h2>Sections of your CV:</h2>
 		<div id="sectionslistid">
 		</div>
 		<i class="fa fa-times" onclick="closesectionsmenu()"></i>
 		<p>To remove just select <b>Remove Section</b></p>
 	</div>

 	<div class="floatingmenu mi" id="missingInformation">
 		<h2 id="missingInformationMSG"><b>Something</b> is missing</h2>
 		<i class="fa fa-times" onclick="closeMissInformation()"></i>
 	</div>
 	

    <script>
		function handleCredentialResponse(response) {
			
   			function reqListener(jsonr) {
   				// var jsonr = JSON.parse(this.responseText);
   				document.getElementById("loggin_id").style.display = "none";
   				console.log(jsonr);
   				if(jsonr.status == "user not available") {
   					document.getElementById("oops_id").style.display = "block";
   					document.getElementById("reasons404").innerHTML = "User not available";

   				} else if (jsonr.status == "token timeout") {
   					document.getElementById("oops_id").style.display = "block";
   					document.getElementById("reasons404").innerHTML = "Token Issues";

   				} else if (jsonr.status == "newUser") {
   					document.getElementById("register_id").style.display = "flex";
					document.getElementById("nameid").value = jsonr.name;
					document.getElementById("lastNameid").value = jsonr.lastName;

   				} else {
   					document.getElementById("oops_id").style.display = "block";
   				}

   			}
   			/*
   			// console.log(response.credential);
   			var oReq = new XMLHttpRequest(); 
   			oReq.addEventListener("load", reqListener);
   			oReq.open("POST", "https://2cj2ftp0e0.execute-api.us-east-1.amazonaws.com/default/telegramCook", true);
   			oReq.send(JSON.stringify({type: "gauth", credential: response.credential}));
   			*/
   			fetch('https://2cj2ftp0e0.execute-api.us-east-1.amazonaws.com/default/telegramCook', {
   				method: 'POST',
   				mode: 'no-cors',
   				headers: {
   					'Content-Type':'application/json',
   				},
   				body: JSON.stringify({type:"gauth", credential:response.credential}),
   			}).then((responseF) => {
   				let json = await responseF.json();
   				return json;
   			}).then((data) => {
   				console.log("here");
   				reqListener(data);

   			}).catch(error => {
   				console.log(error)
   			});
		}

		window.onload = function () {
			/*google.accounts.id.initialize({
				client_id: "YOUR_GOOGLE_CLIENT_ID", // Replace with your Google Client ID
				callback: handleCredentialResponse // We choose to handle the callback in client side, so we include a reference to a function that will handle the response
			});*/
			// You can skip the next instruction if you don't want to show the "Sign-in" button
	  		google.accounts.id.renderButton(
	    		document.getElementById("buttonDiv"), // Ensure the element exist and it is a div to display correcctly
	    		{ theme: "filled_black", size: "large" }  // Customization attributes
	  		);
	  		google.accounts.id.prompt(); // Display the One Tap dialog
		}

    </script>
  </body>
</html>